// Code generated by sqlc. DO NOT EDIT.
// source: riwayat_pelatihan_siasn.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const countRiwayatPelatihanSIASN = `-- name: CountRiwayatPelatihanSIASN :one
SELECT count(*) FROM riwayat_diklat
WHERE nip_baru = $1 AND deleted_at IS NULL
`

func (q *Queries) CountRiwayatPelatihanSIASN(ctx context.Context, nipBaru pgtype.Text) (int64, error) {
	row := q.db.QueryRow(ctx, countRiwayatPelatihanSIASN, nipBaru)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createRiwayatPelatihanSIASN = `-- name: CreateRiwayatPelatihanSIASN :one
insert into riwayat_diklat
    (nama_diklat, jenis_diklat_id, jenis_diklat, institusi_penyelenggara, no_sertifikat, tanggal_mulai, tanggal_selesai, tahun_diklat, durasi_jam, sudah_kirim_siasn, pns_orang_id, nip_baru) values
    ($1, $2, $3, $4, $5, $6, $7, $8, $9, null, $10, $11)
returning id
`

type CreateRiwayatPelatihanSIASNParams struct {
	NamaDiklat             pgtype.Text `db:"nama_diklat"`
	JenisDiklatID          pgtype.Int2 `db:"jenis_diklat_id"`
	JenisDiklat            pgtype.Text `db:"jenis_diklat"`
	InstitusiPenyelenggara pgtype.Text `db:"institusi_penyelenggara"`
	NoSertifikat           pgtype.Text `db:"no_sertifikat"`
	TanggalMulai           pgtype.Date `db:"tanggal_mulai"`
	TanggalSelesai         pgtype.Date `db:"tanggal_selesai"`
	TahunDiklat            pgtype.Int4 `db:"tahun_diklat"`
	DurasiJam              pgtype.Int4 `db:"durasi_jam"`
	PnsOrangID             pgtype.Text `db:"pns_orang_id"`
	NipBaru                pgtype.Text `db:"nip_baru"`
}

func (q *Queries) CreateRiwayatPelatihanSIASN(ctx context.Context, arg CreateRiwayatPelatihanSIASNParams) (int64, error) {
	row := q.db.QueryRow(ctx, createRiwayatPelatihanSIASN,
		arg.NamaDiklat,
		arg.JenisDiklatID,
		arg.JenisDiklat,
		arg.InstitusiPenyelenggara,
		arg.NoSertifikat,
		arg.TanggalMulai,
		arg.TanggalSelesai,
		arg.TahunDiklat,
		arg.DurasiJam,
		arg.PnsOrangID,
		arg.NipBaru,
	)
	var id int64
	err := row.Scan(&id)
	return id, err
}

const deleteRiwayatPelatihanSIASN = `-- name: DeleteRiwayatPelatihanSIASN :execrows
update riwayat_diklat
set deleted_at = now()
where id = $1 and nip_baru = $2::varchar and deleted_at is null
`

type DeleteRiwayatPelatihanSIASNParams struct {
	ID  int64  `db:"id"`
	Nip string `db:"nip"`
}

func (q *Queries) DeleteRiwayatPelatihanSIASN(ctx context.Context, arg DeleteRiwayatPelatihanSIASNParams) (int64, error) {
	result, err := q.db.Exec(ctx, deleteRiwayatPelatihanSIASN, arg.ID, arg.Nip)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}

const getBerkasRiwayatPelatihanSIASN = `-- name: GetBerkasRiwayatPelatihanSIASN :one
select file_base64 from riwayat_diklat
where nip_baru = $1 and id = $2 and deleted_at is null
`

type GetBerkasRiwayatPelatihanSIASNParams struct {
	NipBaru pgtype.Text `db:"nip_baru"`
	ID      int64       `db:"id"`
}

func (q *Queries) GetBerkasRiwayatPelatihanSIASN(ctx context.Context, arg GetBerkasRiwayatPelatihanSIASNParams) (pgtype.Text, error) {
	row := q.db.QueryRow(ctx, getBerkasRiwayatPelatihanSIASN, arg.NipBaru, arg.ID)
	var file_base64 pgtype.Text
	err := row.Scan(&file_base64)
	return file_base64, err
}

const listRiwayatPelatihanSIASN = `-- name: ListRiwayatPelatihanSIASN :many
SELECT
    rd.id,
    rd.jenis_diklat_id,
    rjd.jenis_diklat,
    rd.nama_diklat,
    rd.no_sertifikat,
    rd.tanggal_mulai,
    rd.tanggal_selesai,
    rd.tahun_diklat,
    rd.durasi_jam,
    rd.institusi_penyelenggara
FROM riwayat_diklat rd
LEFT JOIN ref_jenis_diklat rjd ON rd.jenis_diklat_id = rjd.id AND rjd.deleted_at IS NULL
WHERE rd.nip_baru = $1 AND rd.deleted_at IS NULL
ORDER BY rd.tanggal_selesai DESC NULLS LAST
LIMIT $2 OFFSET $3
`

type ListRiwayatPelatihanSIASNParams struct {
	NipBaru pgtype.Text `db:"nip_baru"`
	Limit   int32       `db:"limit"`
	Offset  int32       `db:"offset"`
}

type ListRiwayatPelatihanSIASNRow struct {
	ID                     int64       `db:"id"`
	JenisDiklatID          pgtype.Int2 `db:"jenis_diklat_id"`
	JenisDiklat            pgtype.Text `db:"jenis_diklat"`
	NamaDiklat             pgtype.Text `db:"nama_diklat"`
	NoSertifikat           pgtype.Text `db:"no_sertifikat"`
	TanggalMulai           pgtype.Date `db:"tanggal_mulai"`
	TanggalSelesai         pgtype.Date `db:"tanggal_selesai"`
	TahunDiklat            pgtype.Int4 `db:"tahun_diklat"`
	DurasiJam              pgtype.Int4 `db:"durasi_jam"`
	InstitusiPenyelenggara pgtype.Text `db:"institusi_penyelenggara"`
}

func (q *Queries) ListRiwayatPelatihanSIASN(ctx context.Context, arg ListRiwayatPelatihanSIASNParams) ([]ListRiwayatPelatihanSIASNRow, error) {
	rows, err := q.db.Query(ctx, listRiwayatPelatihanSIASN, arg.NipBaru, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListRiwayatPelatihanSIASNRow
	for rows.Next() {
		var i ListRiwayatPelatihanSIASNRow
		if err := rows.Scan(
			&i.ID,
			&i.JenisDiklatID,
			&i.JenisDiklat,
			&i.NamaDiklat,
			&i.NoSertifikat,
			&i.TanggalMulai,
			&i.TanggalSelesai,
			&i.TahunDiklat,
			&i.DurasiJam,
			&i.InstitusiPenyelenggara,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateRiwayatPelatihanSIASN = `-- name: UpdateRiwayatPelatihanSIASN :execrows
update riwayat_diklat
set
    nama_diklat = $1,
    jenis_diklat_id = $2,
    jenis_diklat = $3,
    institusi_penyelenggara = $4,
    no_sertifikat = $5,
    tanggal_mulai = $6,
    tanggal_selesai = $7,
    tahun_diklat = $8,
    durasi_jam = $9,
    updated_at = now()
where id = $10 and nip_baru = $11::varchar and deleted_at is null
`

type UpdateRiwayatPelatihanSIASNParams struct {
	NamaDiklat             pgtype.Text `db:"nama_diklat"`
	JenisDiklatID          pgtype.Int2 `db:"jenis_diklat_id"`
	JenisDiklat            pgtype.Text `db:"jenis_diklat"`
	InstitusiPenyelenggara pgtype.Text `db:"institusi_penyelenggara"`
	NoSertifikat           pgtype.Text `db:"no_sertifikat"`
	TanggalMulai           pgtype.Date `db:"tanggal_mulai"`
	TanggalSelesai         pgtype.Date `db:"tanggal_selesai"`
	TahunDiklat            pgtype.Int4 `db:"tahun_diklat"`
	DurasiJam              pgtype.Int4 `db:"durasi_jam"`
	ID                     int64       `db:"id"`
	Nip                    string      `db:"nip"`
}

func (q *Queries) UpdateRiwayatPelatihanSIASN(ctx context.Context, arg UpdateRiwayatPelatihanSIASNParams) (int64, error) {
	result, err := q.db.Exec(ctx, updateRiwayatPelatihanSIASN,
		arg.NamaDiklat,
		arg.JenisDiklatID,
		arg.JenisDiklat,
		arg.InstitusiPenyelenggara,
		arg.NoSertifikat,
		arg.TanggalMulai,
		arg.TanggalSelesai,
		arg.TahunDiklat,
		arg.DurasiJam,
		arg.ID,
		arg.Nip,
	)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}

const updateRiwayatPelatihanSIASNNamaNipByPNSID = `-- name: UpdateRiwayatPelatihanSIASNNamaNipByPNSID :exec
UPDATE riwayat_diklat
SET     
    nip_baru = $1::varchar,
    updated_at = now()
WHERE pns_orang_id = $2::varchar AND deleted_at IS NULL
AND (
    ($1::varchar IS NOT NULL AND $1::varchar IS DISTINCT FROM nip_baru)
)
`

type UpdateRiwayatPelatihanSIASNNamaNipByPNSIDParams struct {
	NipBaru string `db:"nip_baru"`
	PnsID   string `db:"pns_id"`
}

func (q *Queries) UpdateRiwayatPelatihanSIASNNamaNipByPNSID(ctx context.Context, arg UpdateRiwayatPelatihanSIASNNamaNipByPNSIDParams) error {
	_, err := q.db.Exec(ctx, updateRiwayatPelatihanSIASNNamaNipByPNSID, arg.NipBaru, arg.PnsID)
	return err
}

const uploadBerkasRiwayatPelatihanSIASN = `-- name: UploadBerkasRiwayatPelatihanSIASN :execrows
update riwayat_diklat
set
    file_base64 = $1,
    updated_at = now()
where id = $2 and nip_baru = $3::varchar and deleted_at is null
`

type UploadBerkasRiwayatPelatihanSIASNParams struct {
	FileBase64 pgtype.Text `db:"file_base64"`
	ID         int64       `db:"id"`
	Nip        string      `db:"nip"`
}

func (q *Queries) UploadBerkasRiwayatPelatihanSIASN(ctx context.Context, arg UploadBerkasRiwayatPelatihanSIASNParams) (int64, error) {
	result, err := q.db.Exec(ctx, uploadBerkasRiwayatPelatihanSIASN, arg.FileBase64, arg.ID, arg.Nip)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}
