// Code generated by sqlc. DO NOT EDIT.
// source: riwayat_pelatihan_siasn.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const countRiwayatPelatihanSIASN = `-- name: CountRiwayatPelatihanSIASN :one
SELECT count(*) FROM riwayat_diklat
WHERE nip_baru = $1 AND deleted_at IS NULL
`

func (q *Queries) CountRiwayatPelatihanSIASN(ctx context.Context, nipBaru pgtype.Text) (int64, error) {
	row := q.db.QueryRow(ctx, countRiwayatPelatihanSIASN, nipBaru)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const getBerkasRiwayatPelatihanSIASN = `-- name: GetBerkasRiwayatPelatihanSIASN :one
select file_base64 from riwayat_diklat
where nip_baru = $1 and id = $2 and deleted_at is null
`

type GetBerkasRiwayatPelatihanSIASNParams struct {
	NipBaru pgtype.Text `db:"nip_baru"`
	ID      int64       `db:"id"`
}

func (q *Queries) GetBerkasRiwayatPelatihanSIASN(ctx context.Context, arg GetBerkasRiwayatPelatihanSIASNParams) (pgtype.Text, error) {
	row := q.db.QueryRow(ctx, getBerkasRiwayatPelatihanSIASN, arg.NipBaru, arg.ID)
	var file_base64 pgtype.Text
	err := row.Scan(&file_base64)
	return file_base64, err
}

const listRiwayatPelatihanSIASN = `-- name: ListRiwayatPelatihanSIASN :many
SELECT
    rd.id,
    rjd.jenis_diklat,
    rd.nama_diklat,
    rd.no_sertifikat,
    rd.tanggal_mulai,
    rd.tanggal_selesai,
    rd.tahun_diklat,
    rd.durasi_jam,
    rd.institusi_penyelenggara
FROM riwayat_diklat rd
LEFT JOIN ref_jenis_diklat rjd ON rd.jenis_diklat_id = rjd.id AND rjd.deleted_at IS NULL
WHERE rd.nip_baru = $1 AND rd.deleted_at IS NULL
ORDER BY rd.tanggal_selesai DESC NULLS LAST
LIMIT $2 OFFSET $3
`

type ListRiwayatPelatihanSIASNParams struct {
	NipBaru pgtype.Text `db:"nip_baru"`
	Limit   int32       `db:"limit"`
	Offset  int32       `db:"offset"`
}

type ListRiwayatPelatihanSIASNRow struct {
	ID                     int64       `db:"id"`
	JenisDiklat            pgtype.Text `db:"jenis_diklat"`
	NamaDiklat             pgtype.Text `db:"nama_diklat"`
	NoSertifikat           pgtype.Text `db:"no_sertifikat"`
	TanggalMulai           pgtype.Date `db:"tanggal_mulai"`
	TanggalSelesai         pgtype.Date `db:"tanggal_selesai"`
	TahunDiklat            pgtype.Int2 `db:"tahun_diklat"`
	DurasiJam              pgtype.Int2 `db:"durasi_jam"`
	InstitusiPenyelenggara pgtype.Text `db:"institusi_penyelenggara"`
}

func (q *Queries) ListRiwayatPelatihanSIASN(ctx context.Context, arg ListRiwayatPelatihanSIASNParams) ([]ListRiwayatPelatihanSIASNRow, error) {
	rows, err := q.db.Query(ctx, listRiwayatPelatihanSIASN, arg.NipBaru, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListRiwayatPelatihanSIASNRow
	for rows.Next() {
		var i ListRiwayatPelatihanSIASNRow
		if err := rows.Scan(
			&i.ID,
			&i.JenisDiklat,
			&i.NamaDiklat,
			&i.NoSertifikat,
			&i.TanggalMulai,
			&i.TanggalSelesai,
			&i.TahunDiklat,
			&i.DurasiJam,
			&i.InstitusiPenyelenggara,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
