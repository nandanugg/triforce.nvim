// Code generated by sqlc. DO NOT EDIT.
// source: data_pribadi.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const getDataPribadi = `-- name: GetDataPribadi :one
select
  pegawai.pns_id,
  pegawai.nama,
  pegawai.gelar_depan,
  pegawai.gelar_belakang,
  case
    when pegawai.jenis_jabatan_id = $2::int and pegawai.pns_id = unit_kerja.pemimpin_pns_id then unit_kerja.nama_jabatan
    else ref_jabatan_aktual.nama_jabatan
  end as jabatan_aktual,
  case
    when pegawai.jenis_jabatan_id = $2::int and pegawai.pns_id = unit_kerja.pemimpin_pns_id then 'Struktural'
    else ref_jenis_jabatan_aktual.nama
  end as jenis_jabatan_aktual,
  pegawai.tmt_jabatan,
  pegawai.unor_id,
  pegawai.nip_baru as nip,
  pegawai.nik,
  pegawai.kk,
  pegawai.jenis_kelamin,
  coalesce(ref_lokasi_tempat_lahir.nama, pegawai.tempat_lahir) as tempat_lahir,
  pegawai.tanggal_lahir,
  ref_tingkat_pendidikan.nama as tingkat_pendidikan,
  ref_pendidikan.nama as pendidikan,
  ref_jenis_kawin.nama as jenis_kawin,
  ref_agama.nama as agama,
  pegawai.email_dikbud,
  pegawai.email,
  pegawai.alamat,
  pegawai.no_hp,
  pegawai.no_darurat,
  ref_jenis_pegawai.nama as jenis_pegawai,
  case
    when pegawai.status_pegawai = 1 and (pegawai.terminated_date is null or pegawai.terminated_date > current_date)
      then (coalesce(extract(year from age(current_date, pegawai.tmt_cpns)), 0) + coalesce(pegawai.mk_tahun_swasta, 0) +
        floor((coalesce(extract(month from age(current_date, pegawai.tmt_cpns)), 0) + coalesce(pegawai.mk_bulan_swasta, 0)) / 12)) || ' Tahun ' ||
        ((coalesce(extract(month from age(current_date, pegawai.tmt_cpns)), 0) + coalesce(pegawai.mk_bulan_swasta, 0)) % 12) || ' Bulan'
  end as masa_kerja_keseluruhan,
  pegawai.masa_kerja as masa_kerja_golongan,
  ref_jabatan.nama_jabatan as jabatan,
  ref_jenis_jabatan.nama as jenis_jabatan,
  ref_kelas_jabatan.kelas_jabatan,
  coalesce(ref_lokasi_lokasi_kerja.nama, pegawai.lokasi_kerja) as lokasi_kerja,
  ref_golongan_akhir.nama_pangkat as pangkat_akhir,
  case when ref_kedudukan_hukum.is_pppk then ref_golongan_awal.gol_pppk else ref_golongan_awal.nama end as golongan_awal,
  case when ref_kedudukan_hukum.is_pppk then ref_golongan_akhir.gol_pppk else ref_golongan_akhir.nama end as golongan_akhir,
  pegawai.tmt_golongan,
  pegawai.tmt_cpns as tmt_asn,
  pegawai.no_sk_cpns as no_sk_asn,
  ref_kedudukan_hukum.is_pppk,
  ref_kedudukan_hukum.nama as status_asn,
  pegawai.status_cpns_pns as status_pns,
  pegawai.tmt_pns,
  pegawai.kartu_pegawai,
  pegawai.no_surat_dokter,
  pegawai.tanggal_surat_dokter,
  pegawai.no_bebas_narkoba,
  pegawai.tanggal_bebas_narkoba,
  pegawai.no_catatan_polisi,
  pegawai.tanggal_catatan_polisi,
  pegawai.akte_kelahiran,
  pegawai.bpjs,
  pegawai.npwp,
  pegawai.tanggal_npwp,
  pegawai.no_taspen
from pegawai
left join ref_lokasi ref_lokasi_tempat_lahir
	on ref_lokasi_tempat_lahir.id = pegawai.tempat_lahir_id and ref_lokasi_tempat_lahir.deleted_at is null
left join ref_agama
	on ref_agama.id = pegawai.agama_id and ref_agama.deleted_at is null
left join ref_tingkat_pendidikan
	on ref_tingkat_pendidikan.id = pegawai.tingkat_pendidikan_id and ref_tingkat_pendidikan.deleted_at is null
left join ref_pendidikan
	on ref_pendidikan.id = pegawai.pendidikan_id and ref_pendidikan.deleted_at is null
left join ref_lokasi ref_lokasi_lokasi_kerja
	on ref_lokasi_lokasi_kerja.id = pegawai.lokasi_kerja_id and ref_lokasi_lokasi_kerja.deleted_at is null
left join ref_jenis_pegawai
	on ref_jenis_pegawai.id = pegawai.jenis_pegawai_id and ref_jenis_pegawai.deleted_at is null
left join ref_golongan ref_golongan_akhir
	on ref_golongan_akhir.id = pegawai.gol_id and ref_golongan_akhir.deleted_at is null
left join ref_golongan ref_golongan_awal
	on ref_golongan_awal.id = pegawai.gol_awal_id and ref_golongan_awal.deleted_at is null
left join ref_kedudukan_hukum
	on ref_kedudukan_hukum.id = pegawai.kedudukan_hukum_id and ref_kedudukan_hukum.deleted_at is null
left join ref_jenis_kawin
	on ref_jenis_kawin.id = pegawai.jenis_kawin_id and ref_jenis_kawin.deleted_at is null
left join unit_kerja
	on unit_kerja.id = pegawai.unor_id and unit_kerja.deleted_at is null
left join ref_jabatan
	on ref_jabatan.kode_jabatan = pegawai.jabatan_instansi_id and ref_jabatan.deleted_at is null
left join ref_jenis_jabatan
	on ref_jenis_jabatan.id = ref_jabatan.jenis_jabatan and ref_jenis_jabatan.deleted_at is null
left join ref_kelas_jabatan
	on ref_kelas_jabatan.id = ref_jabatan.kelas
left join ref_jabatan ref_jabatan_aktual
	on ref_jabatan_aktual.kode_jabatan = pegawai.jabatan_instansi_real_id and ref_jabatan_aktual.deleted_at is null
left join ref_jenis_jabatan ref_jenis_jabatan_aktual
	on ref_jenis_jabatan_aktual.id = ref_jabatan_aktual.jenis_jabatan and ref_jenis_jabatan_aktual.deleted_at is null
where pegawai.nip_baru = $1 and pegawai.deleted_at is null
`

type GetDataPribadiParams struct {
	NipBaru                pgtype.Text `db:"nip_baru"`
	JenisJabatanStruktural int32       `db:"jenis_jabatan_struktural"`
}

type GetDataPribadiRow struct {
	PnsID                string      `db:"pns_id"`
	Nama                 pgtype.Text `db:"nama"`
	GelarDepan           pgtype.Text `db:"gelar_depan"`
	GelarBelakang        pgtype.Text `db:"gelar_belakang"`
	JabatanAktual        interface{} `db:"jabatan_aktual"`
	JenisJabatanAktual   interface{} `db:"jenis_jabatan_aktual"`
	TmtJabatan           pgtype.Date `db:"tmt_jabatan"`
	UnorID               pgtype.Text `db:"unor_id"`
	Nip                  pgtype.Text `db:"nip"`
	Nik                  pgtype.Text `db:"nik"`
	Kk                   pgtype.Text `db:"kk"`
	JenisKelamin         pgtype.Text `db:"jenis_kelamin"`
	TempatLahir          pgtype.Text `db:"tempat_lahir"`
	TanggalLahir         pgtype.Date `db:"tanggal_lahir"`
	TingkatPendidikan    pgtype.Text `db:"tingkat_pendidikan"`
	Pendidikan           pgtype.Text `db:"pendidikan"`
	JenisKawin           pgtype.Text `db:"jenis_kawin"`
	Agama                pgtype.Text `db:"agama"`
	EmailDikbud          pgtype.Text `db:"email_dikbud"`
	Email                pgtype.Text `db:"email"`
	Alamat               pgtype.Text `db:"alamat"`
	NoHp                 pgtype.Text `db:"no_hp"`
	NoDarurat            pgtype.Text `db:"no_darurat"`
	JenisPegawai         pgtype.Text `db:"jenis_pegawai"`
	MasaKerjaKeseluruhan interface{} `db:"masa_kerja_keseluruhan"`
	MasaKerjaGolongan    pgtype.Text `db:"masa_kerja_golongan"`
	Jabatan              pgtype.Text `db:"jabatan"`
	JenisJabatan         pgtype.Text `db:"jenis_jabatan"`
	KelasJabatan         pgtype.Text `db:"kelas_jabatan"`
	LokasiKerja          pgtype.Text `db:"lokasi_kerja"`
	PangkatAkhir         pgtype.Text `db:"pangkat_akhir"`
	GolonganAwal         interface{} `db:"golongan_awal"`
	GolonganAkhir        interface{} `db:"golongan_akhir"`
	TmtGolongan          pgtype.Date `db:"tmt_golongan"`
	TmtAsn               pgtype.Date `db:"tmt_asn"`
	NoSkAsn              pgtype.Text `db:"no_sk_asn"`
	IsPppk               pgtype.Bool `db:"is_pppk"`
	StatusAsn            pgtype.Text `db:"status_asn"`
	StatusPns            pgtype.Text `db:"status_pns"`
	TmtPns               pgtype.Date `db:"tmt_pns"`
	KartuPegawai         pgtype.Text `db:"kartu_pegawai"`
	NoSuratDokter        pgtype.Text `db:"no_surat_dokter"`
	TanggalSuratDokter   pgtype.Date `db:"tanggal_surat_dokter"`
	NoBebasNarkoba       pgtype.Text `db:"no_bebas_narkoba"`
	TanggalBebasNarkoba  pgtype.Date `db:"tanggal_bebas_narkoba"`
	NoCatatanPolisi      pgtype.Text `db:"no_catatan_polisi"`
	TanggalCatatanPolisi pgtype.Date `db:"tanggal_catatan_polisi"`
	AkteKelahiran        pgtype.Text `db:"akte_kelahiran"`
	Bpjs                 pgtype.Text `db:"bpjs"`
	Npwp                 pgtype.Text `db:"npwp"`
	TanggalNpwp          pgtype.Date `db:"tanggal_npwp"`
	NoTaspen             pgtype.Text `db:"no_taspen"`
}

func (q *Queries) GetDataPribadi(ctx context.Context, arg GetDataPribadiParams) (GetDataPribadiRow, error) {
	row := q.db.QueryRow(ctx, getDataPribadi, arg.NipBaru, arg.JenisJabatanStruktural)
	var i GetDataPribadiRow
	err := row.Scan(
		&i.PnsID,
		&i.Nama,
		&i.GelarDepan,
		&i.GelarBelakang,
		&i.JabatanAktual,
		&i.JenisJabatanAktual,
		&i.TmtJabatan,
		&i.UnorID,
		&i.Nip,
		&i.Nik,
		&i.Kk,
		&i.JenisKelamin,
		&i.TempatLahir,
		&i.TanggalLahir,
		&i.TingkatPendidikan,
		&i.Pendidikan,
		&i.JenisKawin,
		&i.Agama,
		&i.EmailDikbud,
		&i.Email,
		&i.Alamat,
		&i.NoHp,
		&i.NoDarurat,
		&i.JenisPegawai,
		&i.MasaKerjaKeseluruhan,
		&i.MasaKerjaGolongan,
		&i.Jabatan,
		&i.JenisJabatan,
		&i.KelasJabatan,
		&i.LokasiKerja,
		&i.PangkatAkhir,
		&i.GolonganAwal,
		&i.GolonganAkhir,
		&i.TmtGolongan,
		&i.TmtAsn,
		&i.NoSkAsn,
		&i.IsPppk,
		&i.StatusAsn,
		&i.StatusPns,
		&i.TmtPns,
		&i.KartuPegawai,
		&i.NoSuratDokter,
		&i.TanggalSuratDokter,
		&i.NoBebasNarkoba,
		&i.TanggalBebasNarkoba,
		&i.NoCatatanPolisi,
		&i.TanggalCatatanPolisi,
		&i.AkteKelahiran,
		&i.Bpjs,
		&i.Npwp,
		&i.TanggalNpwp,
		&i.NoTaspen,
	)
	return i, err
}
