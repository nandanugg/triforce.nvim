// Code generated by sqlc. DO NOT EDIT.
// source: data_pribadi.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const getDataPribadi = `-- name: GetDataPribadi :one
select
  p.nama,
  p.gelar_depan,
  p.gelar_belakang,
  case
    when p.jenis_jabatan_id = $2::int and p.pns_id = uk.pemimpin_pns_id then uk.nama_jabatan
    else rjf.nama_jabatan
  end as jabatan_aktual,
  case
    when p.jenis_jabatan_id = $2::int and p.pns_id = uk.pemimpin_pns_id then 'Struktural'
    else rjj.nama
  end as jenis_jabatan_aktual,
  p.tmt_jabatan,
  p.unor_id,
  p.nip_baru as nip,
  p.nik,
  p.kk,
  p.jenis_kelamin,
  coalesce(rltl.nama, p.tempat_lahir) as tempat_lahir,
  p.tgl_lahir,
  rtp.nama as tingkat_pendidikan,
  rp.nama as pendidikan,
  rjk.nama as jenis_kawin,
  ra.nama as agama,
  p.email_dikbud,
  p.email,
  p.alamat,
  p.no_hp,
  p.no_darurat,
  rjp.nama as jenis_pegawai,
  case
    when p.status_pegawai = 1 and (p.terminated_date is null or p.terminated_date > current_date)
      then (coalesce(extract(year from age(current_date, p.tmt_cpns)), 0) + coalesce(p.mk_tahun_swasta, 0) +
        floor((coalesce(extract(month from age(current_date, p.tmt_cpns)), 0) + coalesce(p.mk_bulan_swasta, 0)) / 12)) || ' Tahun ' ||
        ((coalesce(extract(month from age(current_date, p.tmt_cpns)), 0) + coalesce(p.mk_bulan_swasta, 0)) % 12) || ' Bulan'
  end as masa_kerja_keseluruhan,
  p.masa_kerja as masa_kerja_golongan,
  rj.nama_jabatan as jabatan,
  rkj.kelas_jabatan,
  coalesce(rlk.nama, p.lokasi_kerja) as lokasi_kerja,
  rge.nama_pangkat as pangkat_akhir,
  case when rkh.is_pppk then rgs.gol_pppk else rgs.nama end as golongan_awal,
  case when rkh.is_pppk then rge.gol_pppk else rge.nama end as golongan_akhir,
  p.tmt_golongan,
  p.tmt_cpns as tmt_asn,
  p.no_sk_cpns as no_sk_asn,
  case when rkh.is_pppk then rkh.nama else p.status_cpns_pns end as status_asn,
  case when rkh.is_pppk then null else p.tmt_pns end as tmt_pns,
  p.kartu_pegawai,
  p.no_surat_dokter,
  p.tgl_surat_dokter,
  p.no_bebas_narkoba,
  p.tgl_bebas_narkoba,
  p.no_catatan_polisi,
  p.tgl_catatan_polisi,
  p.akte_kelahiran,
  p.bpjs,
  p.npwp,
  p.tgl_npwp,
  p.no_taspen
from pegawai p
left join ref_lokasi rltl on rltl.id = p.tempat_lahir_id and rltl.deleted_at is null
left join ref_agama ra on ra.id = p.agama_id and ra.deleted_at is null
left join ref_tingkat_pendidikan rtp on rtp.id = p.tingkat_pendidikan_id and rtp.deleted_at is null
left join ref_pendidikan rp on rp.id = p.pendidikan_id and rp.deleted_at is null
left join ref_lokasi rlk on rlk.id = p.lokasi_kerja_id and rlk.deleted_at is null
left join ref_jenis_pegawai rjp on rjp.id = p.jenis_pegawai_id and rjp.deleted_at is null
left join ref_golongan rge on rge.id = p.gol_id and rge.deleted_at is null
left join ref_golongan rgs on rgs.id = p.gol_awal_id and rgs.deleted_at is null
left join ref_kedudukan_hukum rkh on rkh.id = p.kedudukan_hukum_id and rkh.deleted_at is null
left join ref_jenis_kawin rjk on rjk.id = p.jenis_kawin_id and rjk.deleted_at is null
left join unit_kerja uk on uk.id = p.unor_id and uk.deleted_at is null
left join ref_jabatan rj on rj.kode_jabatan = p.jabatan_instansi_id and rj.deleted_at is null
left join ref_kelas_jabatan rkj on rkj.id = rj.kelas
left join ref_jabatan rjf on rjf.kode_jabatan = p.jabatan_instansi_real_id and rjf.deleted_at is null
left join ref_jenis_jabatan rjj on rjj.id = rjf.jenis_jabatan and rjj.deleted_at is null
where p.nip_baru = $1 and p.deleted_at is null
`

type GetDataPribadiParams struct {
	NipBaru                pgtype.Text `db:"nip_baru"`
	JenisJabatanStruktural int32       `db:"jenis_jabatan_struktural"`
}

type GetDataPribadiRow struct {
	Nama                 pgtype.Text `db:"nama"`
	GelarDepan           pgtype.Text `db:"gelar_depan"`
	GelarBelakang        pgtype.Text `db:"gelar_belakang"`
	JabatanAktual        interface{} `db:"jabatan_aktual"`
	JenisJabatanAktual   interface{} `db:"jenis_jabatan_aktual"`
	TmtJabatan           pgtype.Date `db:"tmt_jabatan"`
	UnorID               pgtype.Text `db:"unor_id"`
	Nip                  pgtype.Text `db:"nip"`
	Nik                  pgtype.Text `db:"nik"`
	Kk                   pgtype.Text `db:"kk"`
	JenisKelamin         pgtype.Text `db:"jenis_kelamin"`
	TempatLahir          pgtype.Text `db:"tempat_lahir"`
	TglLahir             pgtype.Date `db:"tgl_lahir"`
	TingkatPendidikan    pgtype.Text `db:"tingkat_pendidikan"`
	Pendidikan           pgtype.Text `db:"pendidikan"`
	JenisKawin           pgtype.Text `db:"jenis_kawin"`
	Agama                pgtype.Text `db:"agama"`
	EmailDikbud          pgtype.Text `db:"email_dikbud"`
	Email                pgtype.Text `db:"email"`
	Alamat               pgtype.Text `db:"alamat"`
	NoHp                 pgtype.Text `db:"no_hp"`
	NoDarurat            pgtype.Text `db:"no_darurat"`
	JenisPegawai         pgtype.Text `db:"jenis_pegawai"`
	MasaKerjaKeseluruhan interface{} `db:"masa_kerja_keseluruhan"`
	MasaKerjaGolongan    pgtype.Text `db:"masa_kerja_golongan"`
	Jabatan              pgtype.Text `db:"jabatan"`
	KelasJabatan         pgtype.Text `db:"kelas_jabatan"`
	LokasiKerja          pgtype.Text `db:"lokasi_kerja"`
	PangkatAkhir         pgtype.Text `db:"pangkat_akhir"`
	GolonganAwal         interface{} `db:"golongan_awal"`
	GolonganAkhir        interface{} `db:"golongan_akhir"`
	TmtGolongan          pgtype.Date `db:"tmt_golongan"`
	TmtAsn               pgtype.Date `db:"tmt_asn"`
	NoSkAsn              pgtype.Text `db:"no_sk_asn"`
	StatusAsn            interface{} `db:"status_asn"`
	TmtPns               interface{} `db:"tmt_pns"`
	KartuPegawai         pgtype.Text `db:"kartu_pegawai"`
	NoSuratDokter        pgtype.Text `db:"no_surat_dokter"`
	TglSuratDokter       pgtype.Date `db:"tgl_surat_dokter"`
	NoBebasNarkoba       pgtype.Text `db:"no_bebas_narkoba"`
	TglBebasNarkoba      pgtype.Date `db:"tgl_bebas_narkoba"`
	NoCatatanPolisi      pgtype.Text `db:"no_catatan_polisi"`
	TglCatatanPolisi     pgtype.Date `db:"tgl_catatan_polisi"`
	AkteKelahiran        pgtype.Text `db:"akte_kelahiran"`
	Bpjs                 pgtype.Text `db:"bpjs"`
	Npwp                 pgtype.Text `db:"npwp"`
	TglNpwp              pgtype.Date `db:"tgl_npwp"`
	NoTaspen             pgtype.Text `db:"no_taspen"`
}

func (q *Queries) GetDataPribadi(ctx context.Context, arg GetDataPribadiParams) (GetDataPribadiRow, error) {
	row := q.db.QueryRow(ctx, getDataPribadi, arg.NipBaru, arg.JenisJabatanStruktural)
	var i GetDataPribadiRow
	err := row.Scan(
		&i.Nama,
		&i.GelarDepan,
		&i.GelarBelakang,
		&i.JabatanAktual,
		&i.JenisJabatanAktual,
		&i.TmtJabatan,
		&i.UnorID,
		&i.Nip,
		&i.Nik,
		&i.Kk,
		&i.JenisKelamin,
		&i.TempatLahir,
		&i.TglLahir,
		&i.TingkatPendidikan,
		&i.Pendidikan,
		&i.JenisKawin,
		&i.Agama,
		&i.EmailDikbud,
		&i.Email,
		&i.Alamat,
		&i.NoHp,
		&i.NoDarurat,
		&i.JenisPegawai,
		&i.MasaKerjaKeseluruhan,
		&i.MasaKerjaGolongan,
		&i.Jabatan,
		&i.KelasJabatan,
		&i.LokasiKerja,
		&i.PangkatAkhir,
		&i.GolonganAwal,
		&i.GolonganAkhir,
		&i.TmtGolongan,
		&i.TmtAsn,
		&i.NoSkAsn,
		&i.StatusAsn,
		&i.TmtPns,
		&i.KartuPegawai,
		&i.NoSuratDokter,
		&i.TglSuratDokter,
		&i.NoBebasNarkoba,
		&i.TglBebasNarkoba,
		&i.NoCatatanPolisi,
		&i.TglCatatanPolisi,
		&i.AkteKelahiran,
		&i.Bpjs,
		&i.Npwp,
		&i.TglNpwp,
		&i.NoTaspen,
	)
	return i, err
}
