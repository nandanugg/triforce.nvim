// Code generated by sqlc. DO NOT EDIT.
// source: riwayat_kenaikan_gaji_berkala.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const countRiwayatKenaikanGajiBerkala = `-- name: CountRiwayatKenaikanGajiBerkala :one
SELECT
    COUNT(1)
FROM
    riwayat_kenaikan_gaji_berkala rk
    JOIN pegawai p ON rk.pegawai_id = p.id
WHERE
    p.nip_baru = $1
    AND p.deleted_at IS NULL
    AND rk.deleted_at IS NULL
`

func (q *Queries) CountRiwayatKenaikanGajiBerkala(ctx context.Context, nipBaru pgtype.Text) (int64, error) {
	row := q.db.QueryRow(ctx, countRiwayatKenaikanGajiBerkala, nipBaru)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const createRiwayatKenaikanGajiBerkala = `-- name: CreateRiwayatKenaikanGajiBerkala :one
insert into riwayat_kenaikan_gaji_berkala (
    pegawai_id,
    tmt_sk,
    no_sk,
    pejabat,
    tanggal_sk,
    pegawai_nama,
    pegawai_nip,
    tempat_lahir,
    tanggal_lahir,
    n_gol_ruang,
    tmt_golongan,
    masa_kerja_golongan_tahun,
    masa_kerja_golongan_bulan,
    jabatan,
    tmt_jabatan,
    golongan_id,
    unit_kerja_induk_text,
    unit_kerja_induk_id,
    kantor_pembayaran,
    pendidikan_terakhir,
    tanggal_lulus_pendidikan_terakhir,
    created_at,
    updated_at,
    gaji_pokok
) values (
    $1,
    $2,
    $3,
    $4,
    $5,
    $6,
    $7,
    $8,
    $9,
    $10,
    $11,
    $12,
    $13,
    $14,
    $15,
    $16,
    $17,
    $18,
    $19,
    $20,
    $21,
    now(),
    now(),
    $22
) returning id
`

type CreateRiwayatKenaikanGajiBerkalaParams struct {
	PegawaiID                      pgtype.Int4 `db:"pegawai_id"`
	TmtSk                          pgtype.Date `db:"tmt_sk"`
	NoSk                           pgtype.Text `db:"no_sk"`
	Pejabat                        pgtype.Text `db:"pejabat"`
	TanggalSk                      pgtype.Date `db:"tanggal_sk"`
	PegawaiNama                    pgtype.Text `db:"pegawai_nama"`
	PegawaiNip                     pgtype.Text `db:"pegawai_nip"`
	TempatLahir                    pgtype.Text `db:"tempat_lahir"`
	TanggalLahir                   pgtype.Date `db:"tanggal_lahir"`
	NGolRuang                      pgtype.Text `db:"n_gol_ruang"`
	TmtGolongan                    pgtype.Date `db:"tmt_golongan"`
	MasaKerjaGolonganTahun         pgtype.Int2 `db:"masa_kerja_golongan_tahun"`
	MasaKerjaGolonganBulan         pgtype.Int2 `db:"masa_kerja_golongan_bulan"`
	Jabatan                        pgtype.Text `db:"jabatan"`
	TmtJabatan                     pgtype.Date `db:"tmt_jabatan"`
	GolonganID                     pgtype.Int4 `db:"golongan_id"`
	UnitKerjaIndukText             pgtype.Text `db:"unit_kerja_induk_text"`
	UnitKerjaIndukID               pgtype.Text `db:"unit_kerja_induk_id"`
	KantorPembayaran               pgtype.Text `db:"kantor_pembayaran"`
	PendidikanTerakhir             pgtype.Text `db:"pendidikan_terakhir"`
	TanggalLulusPendidikanTerakhir pgtype.Date `db:"tanggal_lulus_pendidikan_terakhir"`
	GajiPokok                      pgtype.Int4 `db:"gaji_pokok"`
}

func (q *Queries) CreateRiwayatKenaikanGajiBerkala(ctx context.Context, arg CreateRiwayatKenaikanGajiBerkalaParams) (int64, error) {
	row := q.db.QueryRow(ctx, createRiwayatKenaikanGajiBerkala,
		arg.PegawaiID,
		arg.TmtSk,
		arg.NoSk,
		arg.Pejabat,
		arg.TanggalSk,
		arg.PegawaiNama,
		arg.PegawaiNip,
		arg.TempatLahir,
		arg.TanggalLahir,
		arg.NGolRuang,
		arg.TmtGolongan,
		arg.MasaKerjaGolonganTahun,
		arg.MasaKerjaGolonganBulan,
		arg.Jabatan,
		arg.TmtJabatan,
		arg.GolonganID,
		arg.UnitKerjaIndukText,
		arg.UnitKerjaIndukID,
		arg.KantorPembayaran,
		arg.PendidikanTerakhir,
		arg.TanggalLulusPendidikanTerakhir,
		arg.GajiPokok,
	)
	var id int64
	err := row.Scan(&id)
	return id, err
}

const deleteRiwayatKenaikanGajiBerkala = `-- name: DeleteRiwayatKenaikanGajiBerkala :execrows
update riwayat_kenaikan_gaji_berkala set
    deleted_at = now()
where id = $1 and pegawai_id = $2 and deleted_at is null
`

type DeleteRiwayatKenaikanGajiBerkalaParams struct {
	ID        int64       `db:"id"`
	PegawaiID pgtype.Int4 `db:"pegawai_id"`
}

func (q *Queries) DeleteRiwayatKenaikanGajiBerkala(ctx context.Context, arg DeleteRiwayatKenaikanGajiBerkalaParams) (int64, error) {
	result, err := q.db.Exec(ctx, deleteRiwayatKenaikanGajiBerkala, arg.ID, arg.PegawaiID)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}

const getBerkasRiwayatKenaikanGajiBerkala = `-- name: GetBerkasRiwayatKenaikanGajiBerkala :one
SELECT
    file_base64
FROM
    riwayat_kenaikan_gaji_berkala rk
    JOIN pegawai p ON rk.pegawai_id = p.id
WHERE
    p.nip_baru = $1
    AND rk.id = $2
    AND rk.deleted_at IS NULL
`

type GetBerkasRiwayatKenaikanGajiBerkalaParams struct {
	NipBaru pgtype.Text `db:"nip_baru"`
	ID      int64       `db:"id"`
}

func (q *Queries) GetBerkasRiwayatKenaikanGajiBerkala(ctx context.Context, arg GetBerkasRiwayatKenaikanGajiBerkalaParams) (pgtype.Text, error) {
	row := q.db.QueryRow(ctx, getBerkasRiwayatKenaikanGajiBerkala, arg.NipBaru, arg.ID)
	var file_base64 pgtype.Text
	err := row.Scan(&file_base64)
	return file_base64, err
}

const listRiwayatKenaikanGajiBerkala = `-- name: ListRiwayatKenaikanGajiBerkala :many
SELECT
    rk.id,
    rg.id AS golongan_id,
    rg.nama AS golongan_nama,
    rg.nama_pangkat AS golongan_nama_pangkat,
    rk.no_sk,
    rk.tanggal_sk,
    rk.tmt_golongan,
    rk.masa_kerja_golongan_tahun,
    rk.masa_kerja_golongan_bulan,
    rk.tmt_sk AS tmt_kenaikan_gaji_berkala,
    rk.gaji_pokok,
    rk.jabatan,
    rk.tmt_jabatan,
    rk.pendidikan_terakhir AS pendidikan,
    rk.tanggal_lulus_pendidikan_terakhir AS tanggal_lulus,
    rk.kantor_pembayaran,
    rk.unit_kerja_induk_id,
    uk.nama_unor AS unit_kerja_induk,
    rk.pejabat
FROM
    riwayat_kenaikan_gaji_berkala rk
    JOIN pegawai p ON rk.pegawai_id = p.id
    LEFT JOIN ref_golongan rg ON rk.golongan_id = rg.id AND rg.deleted_at IS NULL
    LEFT JOIN ref_unit_kerja uk ON rk.unit_kerja_induk_id = uk.id AND uk.deleted_at IS NULL
WHERE
    p.nip_baru = $1
    AND p.deleted_at IS NULL
    AND rk.deleted_at IS NULL
ORDER BY
    rk.tmt_sk DESC
LIMIT
    $2
OFFSET
    $3
`

type ListRiwayatKenaikanGajiBerkalaParams struct {
	NipBaru pgtype.Text `db:"nip_baru"`
	Limit   int32       `db:"limit"`
	Offset  int32       `db:"offset"`
}

type ListRiwayatKenaikanGajiBerkalaRow struct {
	ID                     int64       `db:"id"`
	GolonganID             pgtype.Int4 `db:"golongan_id"`
	GolonganNama           pgtype.Text `db:"golongan_nama"`
	GolonganNamaPangkat    pgtype.Text `db:"golongan_nama_pangkat"`
	NoSk                   pgtype.Text `db:"no_sk"`
	TanggalSk              pgtype.Date `db:"tanggal_sk"`
	TmtGolongan            pgtype.Date `db:"tmt_golongan"`
	MasaKerjaGolonganTahun pgtype.Int2 `db:"masa_kerja_golongan_tahun"`
	MasaKerjaGolonganBulan pgtype.Int2 `db:"masa_kerja_golongan_bulan"`
	TmtKenaikanGajiBerkala pgtype.Date `db:"tmt_kenaikan_gaji_berkala"`
	GajiPokok              pgtype.Int4 `db:"gaji_pokok"`
	Jabatan                pgtype.Text `db:"jabatan"`
	TmtJabatan             pgtype.Date `db:"tmt_jabatan"`
	Pendidikan             pgtype.Text `db:"pendidikan"`
	TanggalLulus           pgtype.Date `db:"tanggal_lulus"`
	KantorPembayaran       pgtype.Text `db:"kantor_pembayaran"`
	UnitKerjaIndukID       pgtype.Text `db:"unit_kerja_induk_id"`
	UnitKerjaInduk         pgtype.Text `db:"unit_kerja_induk"`
	Pejabat                pgtype.Text `db:"pejabat"`
}

func (q *Queries) ListRiwayatKenaikanGajiBerkala(ctx context.Context, arg ListRiwayatKenaikanGajiBerkalaParams) ([]ListRiwayatKenaikanGajiBerkalaRow, error) {
	rows, err := q.db.Query(ctx, listRiwayatKenaikanGajiBerkala, arg.NipBaru, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListRiwayatKenaikanGajiBerkalaRow
	for rows.Next() {
		var i ListRiwayatKenaikanGajiBerkalaRow
		if err := rows.Scan(
			&i.ID,
			&i.GolonganID,
			&i.GolonganNama,
			&i.GolonganNamaPangkat,
			&i.NoSk,
			&i.TanggalSk,
			&i.TmtGolongan,
			&i.MasaKerjaGolonganTahun,
			&i.MasaKerjaGolonganBulan,
			&i.TmtKenaikanGajiBerkala,
			&i.GajiPokok,
			&i.Jabatan,
			&i.TmtJabatan,
			&i.Pendidikan,
			&i.TanggalLulus,
			&i.KantorPembayaran,
			&i.UnitKerjaIndukID,
			&i.UnitKerjaInduk,
			&i.Pejabat,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const updateRiwayatKenaikanGajiBerkala = `-- name: UpdateRiwayatKenaikanGajiBerkala :execrows
update riwayat_kenaikan_gaji_berkala set
    tmt_sk = $1,
    no_sk = $2,
    pejabat = $3,
    tanggal_sk = $4,
    n_gol_ruang = $5,
    tmt_golongan = $6,
    masa_kerja_golongan_tahun = $7,
    masa_kerja_golongan_bulan = $8,
    jabatan = $9,
    tmt_jabatan = $10,
    golongan_id = $11,
    unit_kerja_induk_text = $12,
    unit_kerja_induk_id = $13,
    kantor_pembayaran = $14,
    pendidikan_terakhir = $15,
    tanggal_lulus_pendidikan_terakhir = $16,
    gaji_pokok = $17,
    updated_at = now()
where id = $18 and pegawai_id = $19 and deleted_at is null
`

type UpdateRiwayatKenaikanGajiBerkalaParams struct {
	TmtSk                          pgtype.Date `db:"tmt_sk"`
	NoSk                           pgtype.Text `db:"no_sk"`
	Pejabat                        pgtype.Text `db:"pejabat"`
	TanggalSk                      pgtype.Date `db:"tanggal_sk"`
	NGolRuang                      pgtype.Text `db:"n_gol_ruang"`
	TmtGolongan                    pgtype.Date `db:"tmt_golongan"`
	MasaKerjaGolonganTahun         pgtype.Int2 `db:"masa_kerja_golongan_tahun"`
	MasaKerjaGolonganBulan         pgtype.Int2 `db:"masa_kerja_golongan_bulan"`
	Jabatan                        pgtype.Text `db:"jabatan"`
	TmtJabatan                     pgtype.Date `db:"tmt_jabatan"`
	GolonganID                     pgtype.Int4 `db:"golongan_id"`
	UnitKerjaIndukText             pgtype.Text `db:"unit_kerja_induk_text"`
	UnitKerjaIndukID               pgtype.Text `db:"unit_kerja_induk_id"`
	KantorPembayaran               pgtype.Text `db:"kantor_pembayaran"`
	PendidikanTerakhir             pgtype.Text `db:"pendidikan_terakhir"`
	TanggalLulusPendidikanTerakhir pgtype.Date `db:"tanggal_lulus_pendidikan_terakhir"`
	GajiPokok                      pgtype.Int4 `db:"gaji_pokok"`
	ID                             int64       `db:"id"`
	PegawaiID                      pgtype.Int4 `db:"pegawai_id"`
}

func (q *Queries) UpdateRiwayatKenaikanGajiBerkala(ctx context.Context, arg UpdateRiwayatKenaikanGajiBerkalaParams) (int64, error) {
	result, err := q.db.Exec(ctx, updateRiwayatKenaikanGajiBerkala,
		arg.TmtSk,
		arg.NoSk,
		arg.Pejabat,
		arg.TanggalSk,
		arg.NGolRuang,
		arg.TmtGolongan,
		arg.MasaKerjaGolonganTahun,
		arg.MasaKerjaGolonganBulan,
		arg.Jabatan,
		arg.TmtJabatan,
		arg.GolonganID,
		arg.UnitKerjaIndukText,
		arg.UnitKerjaIndukID,
		arg.KantorPembayaran,
		arg.PendidikanTerakhir,
		arg.TanggalLulusPendidikanTerakhir,
		arg.GajiPokok,
		arg.ID,
		arg.PegawaiID,
	)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}

const updateRiwayatKenaikanGajiBerkalaNamaNipByPNSID = `-- name: UpdateRiwayatKenaikanGajiBerkalaNamaNipByPNSID :exec
UPDATE riwayat_kenaikan_gaji_berkala
SET 
    pegawai_nama = $1::varchar,
    pegawai_nip = $2::varchar,
    tanggal_lahir = $3::date,
    updated_at = now()
WHERE pegawai_nip = $4::varchar AND deleted_at IS NULL
AND (
    ($2::varchar IS NOT NULL AND $2::varchar IS DISTINCT FROM pegawai_nip)
    OR ($1::varchar IS NOT NULL AND $1::varchar IS DISTINCT FROM pegawai_nama)
    OR ($3::date IS NOT NULL AND $3::date IS DISTINCT FROM tanggal_lahir)
)
`

type UpdateRiwayatKenaikanGajiBerkalaNamaNipByPNSIDParams struct {
	Nama         string      `db:"nama"`
	NipBaru      string      `db:"nip_baru"`
	TanggalLahir pgtype.Date `db:"tanggal_lahir"`
	Nip          string      `db:"nip"`
}

func (q *Queries) UpdateRiwayatKenaikanGajiBerkalaNamaNipByPNSID(ctx context.Context, arg UpdateRiwayatKenaikanGajiBerkalaNamaNipByPNSIDParams) error {
	_, err := q.db.Exec(ctx, updateRiwayatKenaikanGajiBerkalaNamaNipByPNSID,
		arg.Nama,
		arg.NipBaru,
		arg.TanggalLahir,
		arg.Nip,
	)
	return err
}

const uploadBerkasRiwayatKenaikanGajiBerkala = `-- name: UploadBerkasRiwayatKenaikanGajiBerkala :execrows
update riwayat_kenaikan_gaji_berkala set
    file_base64 = $1,
    updated_at = now()
where id = $2 and pegawai_id = $3 and deleted_at is null
`

type UploadBerkasRiwayatKenaikanGajiBerkalaParams struct {
	FileBase64 pgtype.Text `db:"file_base64"`
	ID         int64       `db:"id"`
	PegawaiID  pgtype.Int4 `db:"pegawai_id"`
}

func (q *Queries) UploadBerkasRiwayatKenaikanGajiBerkala(ctx context.Context, arg UploadBerkasRiwayatKenaikanGajiBerkalaParams) (int64, error) {
	result, err := q.db.Exec(ctx, uploadBerkasRiwayatKenaikanGajiBerkala, arg.FileBase64, arg.ID, arg.PegawaiID)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}
