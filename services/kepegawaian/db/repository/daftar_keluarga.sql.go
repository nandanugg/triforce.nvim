// Code generated by sqlc. DO NOT EDIT.
// source: daftar_keluarga.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const listAnakByNip = `-- name: ListAnakByNip :many
SELECT
    a.id,
    a.pasangan_id,
    a.nama,
    a.jenis_kelamin,
    a.tanggal_lahir,
    a.status_anak,
    ROW_NUMBER() OVER (
        PARTITION BY a.pns_id
        ORDER BY
            a.tanggal_lahir ASC NULLS LAST,
            a.id ASC  -- tie-breaker for same date or nulls
    ) AS anak_ke,
    pas.nama AS nama_orang_tua
FROM anak a
JOIN pegawai pg ON a.pns_id = pg.pns_id AND pg.deleted_at is null
LEFT JOIN pasangan pas ON a.pasangan_id = pas.id AND pas.deleted_at is null
WHERE a.deleted_at IS NULL
AND pg.nip_baru = $1
ORDER BY a.pns_id, anak_ke
`

type ListAnakByNipRow struct {
	ID           int64       `db:"id"`
	PasanganID   pgtype.Int8 `db:"pasangan_id"`
	Nama         pgtype.Text `db:"nama"`
	JenisKelamin pgtype.Text `db:"jenis_kelamin"`
	TanggalLahir pgtype.Date `db:"tanggal_lahir"`
	StatusAnak   pgtype.Text `db:"status_anak"`
	AnakKe       int64       `db:"anak_ke"`
	NamaOrangTua pgtype.Text `db:"nama_orang_tua"`
}

func (q *Queries) ListAnakByNip(ctx context.Context, nipBaru pgtype.Text) ([]ListAnakByNipRow, error) {
	rows, err := q.db.Query(ctx, listAnakByNip, nipBaru)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListAnakByNipRow
	for rows.Next() {
		var i ListAnakByNipRow
		if err := rows.Scan(
			&i.ID,
			&i.PasanganID,
			&i.Nama,
			&i.JenisKelamin,
			&i.TanggalLahir,
			&i.StatusAnak,
			&i.AnakKe,
			&i.NamaOrangTua,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listOrangTuaByNip = `-- name: ListOrangTuaByNip :many
SELECT
    ot.id,
    ot.hubungan,
    ot.nama,
    ot.tgl_meninggal,
    ot.no_dokumen AS nik,
    ot.agama_id,
    ot.akte_meninggal AS dokumen_pendukung,
    ra.nama AS agama_nama
FROM orang_tua ot
JOIN pegawai pg ON ot.pns_id = pg.pns_id AND pg.deleted_at is null
LEFT JOIN ref_agama ra ON ot.agama_id = ra.id AND ra.deleted_at is null
WHERE ot.deleted_at IS NULL
AND pg.nip_baru = $1
`

type ListOrangTuaByNipRow struct {
	ID               int32       `db:"id"`
	Hubungan         pgtype.Int2 `db:"hubungan"`
	Nama             pgtype.Text `db:"nama"`
	TglMeninggal     pgtype.Date `db:"tgl_meninggal"`
	Nik              pgtype.Text `db:"nik"`
	AgamaID          pgtype.Int2 `db:"agama_id"`
	DokumenPendukung pgtype.Text `db:"dokumen_pendukung"`
	AgamaNama        pgtype.Text `db:"agama_nama"`
}

func (q *Queries) ListOrangTuaByNip(ctx context.Context, nipBaru pgtype.Text) ([]ListOrangTuaByNipRow, error) {
	rows, err := q.db.Query(ctx, listOrangTuaByNip, nipBaru)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListOrangTuaByNipRow
	for rows.Next() {
		var i ListOrangTuaByNipRow
		if err := rows.Scan(
			&i.ID,
			&i.Hubungan,
			&i.Nama,
			&i.TglMeninggal,
			&i.Nik,
			&i.AgamaID,
			&i.DokumenPendukung,
			&i.AgamaNama,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listPasanganByNip = `-- name: ListPasanganByNip :many
SELECT
    p.id,
    p.pns,
    p.nama,
    p.karsus,
    p.status,
    ra.nama AS agama,
    p.tanggal_lahir,
    p.tanggal_menikah,
    p.akte_nikah,
    p.akte_cerai,
    p.tanggal_cerai,
    p.akte_meninggal,
    p.tanggal_meninggal
FROM pasangan p
JOIN pegawai pg ON p.pns_id = pg.pns_id AND pg.deleted_at is null
LEFT JOIN ref_agama ra ON pg.agama_id = ra.id AND ra.deleted_at is null
WHERE p.deleted_at IS NULL
AND pg.nip_baru = $1
`

type ListPasanganByNipRow struct {
	ID               int64       `db:"id"`
	Pns              pgtype.Int2 `db:"pns"`
	Nama             pgtype.Text `db:"nama"`
	Karsus           pgtype.Text `db:"karsus"`
	Status           pgtype.Int2 `db:"status"`
	Agama            pgtype.Text `db:"agama"`
	TanggalLahir     pgtype.Date `db:"tanggal_lahir"`
	TanggalMenikah   pgtype.Date `db:"tanggal_menikah"`
	AkteNikah        pgtype.Text `db:"akte_nikah"`
	AkteCerai        pgtype.Text `db:"akte_cerai"`
	TanggalCerai     pgtype.Date `db:"tanggal_cerai"`
	AkteMeninggal    pgtype.Text `db:"akte_meninggal"`
	TanggalMeninggal pgtype.Date `db:"tanggal_meninggal"`
}

func (q *Queries) ListPasanganByNip(ctx context.Context, nipBaru pgtype.Text) ([]ListPasanganByNipRow, error) {
	rows, err := q.db.Query(ctx, listPasanganByNip, nipBaru)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListPasanganByNipRow
	for rows.Next() {
		var i ListPasanganByNipRow
		if err := rows.Scan(
			&i.ID,
			&i.Pns,
			&i.Nama,
			&i.Karsus,
			&i.Status,
			&i.Agama,
			&i.TanggalLahir,
			&i.TanggalMenikah,
			&i.AkteNikah,
			&i.AkteCerai,
			&i.TanggalCerai,
			&i.AkteMeninggal,
			&i.TanggalMeninggal,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
