// Code generated by sqlc. DO NOT EDIT.
// source: riwayat_hukdis.sql

package repository

import (
	"context"

	"github.com/jackc/pgx/v5/pgtype"
)

const countRiwayatHukdis = `-- name: CountRiwayatHukdis :one
SELECT COUNT(1)
FROM riwayat_hukdis rh
WHERE pns_nip = $1
  AND rh.deleted_at is null
`

func (q *Queries) CountRiwayatHukdis(ctx context.Context, pnsNip pgtype.Text) (int64, error) {
	row := q.db.QueryRow(ctx, countRiwayatHukdis, pnsNip)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const getBerkasRiwayatHukdis = `-- name: GetBerkasRiwayatHukdis :one
SELECT file_base64 
FROM riwayat_hukdis rh
WHERE pns_nip = $1
  AND rh.id = $2
  AND rh.deleted_at is null
`

type GetBerkasRiwayatHukdisParams struct {
	PnsNip pgtype.Text `db:"pns_nip"`
	ID     int64       `db:"id"`
}

func (q *Queries) GetBerkasRiwayatHukdis(ctx context.Context, arg GetBerkasRiwayatHukdisParams) (pgtype.Text, error) {
	row := q.db.QueryRow(ctx, getBerkasRiwayatHukdis, arg.PnsNip, arg.ID)
	var file_base64 pgtype.Text
	err := row.Scan(&file_base64)
	return file_base64, err
}

const listRiwayatHukdis = `-- name: ListRiwayatHukdis :many
SELECT
  rh.id,
  COALESCE(rh.nama_jenis_hukuman, rjh.nama) as jenis_hukuman,
  rg.nama as nama_golongan,
  rg.nama_pangkat,
  tanggal_mulai_hukuman,
  tanggal_akhir_hukuman,
  masa_tahun,
  masa_bulan,
  sk_nomor,
  sk_tanggal
FROM riwayat_hukdis rh
LEFT JOIN ref_jenis_hukuman rjh ON rh.jenis_hukuman_id=rjh.id AND rjh.deleted_at is null
LEFT JOIN ref_golongan rg ON rh.golongan_id=rg.id AND rg.deleted_at is null
WHERE pns_nip = $1
  AND rh.deleted_at is null
ORDER BY sk_tanggal DESC
LIMIT $2 OFFSET $3
`

type ListRiwayatHukdisParams struct {
	PnsNip pgtype.Text `db:"pns_nip"`
	Limit  int32       `db:"limit"`
	Offset int32       `db:"offset"`
}

type ListRiwayatHukdisRow struct {
	ID                  int64       `db:"id"`
	JenisHukuman        pgtype.Text `db:"jenis_hukuman"`
	NamaGolongan        pgtype.Text `db:"nama_golongan"`
	NamaPangkat         pgtype.Text `db:"nama_pangkat"`
	TanggalMulaiHukuman pgtype.Date `db:"tanggal_mulai_hukuman"`
	TanggalAkhirHukuman pgtype.Date `db:"tanggal_akhir_hukuman"`
	MasaTahun           pgtype.Int2 `db:"masa_tahun"`
	MasaBulan           pgtype.Int2 `db:"masa_bulan"`
	SkNomor             pgtype.Text `db:"sk_nomor"`
	SkTanggal           pgtype.Date `db:"sk_tanggal"`
}

func (q *Queries) ListRiwayatHukdis(ctx context.Context, arg ListRiwayatHukdisParams) ([]ListRiwayatHukdisRow, error) {
	rows, err := q.db.Query(ctx, listRiwayatHukdis, arg.PnsNip, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ListRiwayatHukdisRow
	for rows.Next() {
		var i ListRiwayatHukdisRow
		if err := rows.Scan(
			&i.ID,
			&i.JenisHukuman,
			&i.NamaGolongan,
			&i.NamaPangkat,
			&i.TanggalMulaiHukuman,
			&i.TanggalAkhirHukuman,
			&i.MasaTahun,
			&i.MasaBulan,
			&i.SkNomor,
			&i.SkTanggal,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
